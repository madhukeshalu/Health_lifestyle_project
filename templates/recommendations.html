{% extends "base.html" %}

{% block title %}Recommendations - HealthGuard{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row mb-5" data-aos="fade-up">
        <div class="col-lg-8 mx-auto text-center">
            <h1 class="display-4 fw-bold mb-3">Your Personalized Health Plan</h1>
            <p class="lead text-muted">Actionable recommendations tailored to your unique health profile and risk
                factors.</p>
        </div>
    </div>

    {% if result %}
    <div class="row g-4">
        <!-- Risk Status Card -->
        <div class="col-12" data-aos="fade-up">
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body p-4">
                    <div class="d-flex align-items-center justify-content-between flex-wrap gap-3">
                        <div>
                            <h4 class="mb-1">Assessment Summary</h4>
                            <p class="mb-0 text-muted">Based on your recent health screening</p>
                        </div>
                        <div class="d-flex gap-3">
                            <span
                                class="badge {% if result.final_risk_category == 'High Risk' %}bg-danger{% elif result.final_risk_category == 'Medium Risk' %}bg-warning{% else %}bg-success{% endif %} p-3 rounded-pill">
                                {{ result.final_risk_category }}
                            </span>
                            <span class="badge bg-light text-dark border p-3 rounded-pill">
                                Wellness Score: {{ result.wellness_score }}/100
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        {% if result.recommendations %}
        {% for category, items in result.recommendations.items() %}
        <div class="col-md-6" data-aos="fade-up" data-aos-delay="{{ loop.index * 100 }}">
            <div class="card h-100 border-0 shadow-hover transition-all">
                <div class="card-header bg-white border-bottom-0 pt-4 px-4">
                    <div class="d-flex align-items-center">
                        <div class="icon-box rounded-circle p-3 me-3 
                                {% if 'Diet' in category or 'Nutrition' in category %}bg-success-subtle text-success
                                {% elif 'Exercise' in category or 'Physical' in category %}bg-info-subtle text-info
                                {% elif 'Sleep' in category %}bg-primary-subtle text-primary
                                {% elif 'Stress' in category or 'Mental' in category %}bg-warning-subtle text-warning
                                {% else %}bg-secondary-subtle text-secondary{% endif %}">
                            <i class="fas 
                                    {% if 'Diet' in category or 'Nutrition' in category %}fa-apple-alt
                                    {% elif 'Exercise' in category or 'Physical' in category %}fa-running
                                    {% elif 'Sleep' in category %}fa-bed
                                    {% elif 'Stress' in category or 'Mental' in category %}fa-brain
                                    {% else %}fa-heartbeat{% endif %} fa-lg"></i>
                        </div>
                        <h4 class="mb-0 fw-bold">{{ category }}</h4>
                    </div>
                </div>
                <div class="card-body px-4 pb-4">
                    <ul class="list-group list-group-flush">
                        {% for item in items %}
                        <li class="list-group-item border-0 px-0 py-2 d-flex align-items-start">
                            <i class="fas fa-check-circle text-primary mt-1 me-3"></i>
                            <span>{{ item }}</span>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
        {% endfor %}
        {% else %}
        <div class="col-12 text-center py-5">
            <i class="fas fa-check-circle fa-4x text-success mb-3"></i>
            <h3>You're doing great!</h3>
            <p class="text-muted">No specific recommendations found based on your current profile. Keep up the good
                work!</p>
        </div>
        {% endif %}

        <div class="col-12 text-center mt-5" data-aos="fade-up">
            <a href="{{ url_for('generate_report') }}" class="btn btn-primary btn-lg px-5">
                <i class="fas fa-download me-2"></i>Download Full Plan
            </a>
            <a href="{{ url_for('predict') }}" class="btn btn-outline-secondary btn-lg px-5 py-3 rounded-pill ms-3">
                <i class="fas fa-redo me-2"></i>New Assessment
            </a>
            <a href="{{ url_for('show_results') }}"
                class="btn btn-primary btn-lg px-5 py-3 rounded-pill shadow-sm hover-scale">
                <i class="fas fa-chart-line me-2"></i>View Analysis
            </a>
        </div>
    </div>
    {% else %}
    <div class="row">
        <div class="col-12">
            <div class="card text-center py-5 shadow-sm" data-aos="fade-up">
                <div class="card-body">
                    <i class="fas fa-clipboard-list fa-4x text-muted mb-4"></i>
                    <h3 class="mb-3">No Recommendations Available</h3>
                    <p class="text-muted mb-4">Please complete a health assessment to receive personalized
                        recommendations.</p>
                    <a href="{{ url_for('predict') }}" class="btn btn-primary btn-lg px-5 rounded-pill">
                        <i class="fas fa-play me-2"></i>Start Assessment
                    </a>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}